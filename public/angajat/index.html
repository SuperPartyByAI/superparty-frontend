<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>SuperParty - Dashboard angajat (DEBUG)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    body {
      background: #0f172a;
      color: #e5e7eb;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    }
  </style>

  <!-- ==========================
       DIAGNOSTICARE REFRESH LOOP
       ========================== -->
  <script>
    console.log("DEBUG: Script diagnosticare pornit.");

    // 1) Detectăm refresh repetat
    const lastLoad = localStorage.getItem("lastPageLoad");
    const now = Date.now();

    if (lastLoad && now - lastLoad < 3000) {
      console.warn("⚠️ DETECTAT REFRESH LOOP!");
      alert("⚠️ Pagina se autoreîncarcă! Vezi consola (F12).");
    }
    localStorage.setItem("lastPageLoad", now);

    // 2) Detectăm redirecturi forțate
    (function () {
      const originalHref = Object.getOwnPropertyDescriptor(Location.prototype, "href");

      Object.defineProperty(window.location, "href", {
        set: function (val) {
          console.error("⚠️ REDIRECT DETECTAT CĂTRE:", val);
          alert("⚠️ Redirect detectat către: " + val);
        },
        get: function () {
          return originalHref.get.call(window.location);
        }
      });
    })();

    // 3) Interceptare location.reload()
    const origReload = window.location.reload;
    window.location.reload = function () {
      console.error("⚠️ APEL location.reload() detectat!");
      alert("⚠️ Scriptul cheamă reload() !");
    };

    // 4) Afișează toate erorile JS
    window.onerror = function (msg, url, line) {
      console.error("⚠️ EROARE JS:", msg, "la", url, "linia", line);
      alert("⚠️ Eroare JS: " + msg + " (linia " + line + ")");
    };
  </script>
</head>

<body>
  <h1>DEBUG - Pagina angajat</h1>
  <p>Dacă vezi acest text, pagina nu ar trebui să dea refresh automat.</p>

  <p>Deschide consola (F12 → Console) și spune-mi ce mesaj apare acolo.</p>
</body>
</html>
