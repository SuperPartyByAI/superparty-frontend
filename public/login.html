<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>SuperParty - Autentificare</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 16px;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: radial-gradient(circle at top, #1d4ed8 0%, #0f172a 45%, #020617 100%);
      color: #e5e7eb;
    }

    .card {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      padding: 24px 26px;
      width: 100%;
      max-width: 420px;
      box-shadow: 0 22px 60px rgba(0, 0, 0, 0.6);
      border: 1px solid rgba(30, 64, 175, 0.5);
    }

    .logo {
      font-size: 22px;
      font-weight: 700;
      letter-spacing: 0.04em;
      margin-bottom: 4px;
      text-align: center;
    }

    .subtitle {
      font-size: 13px;
      color: #9ca3af;
      text-align: center;
      margin-bottom: 18px;
    }

    label {
      display: block;
      font-size: 13px;
      margin-bottom: 6px;
      color: #cbd5e1;
    }

    input[type="email"],
    input[type="password"] {
      width: 100%;
      padding: 11px 12px;
      border-radius: 10px;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      font-size: 14px;
      margin-bottom: 14px;
      outline: none;
      transition: border 0.15s, box-shadow 0.15s;
    }

    input[type="email"]:focus,
    input[type="password"]:focus {
      border-color: #3b82f6;
      box-shadow: 0 0 0 1px rgba(59, 130, 246, 0.7);
    }

    .actions-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 4px;
      margin-bottom: 10px;
      font-size: 12px;
      color: #9ca3af;
    }

    .link {
      color: #60a5fa;
      cursor: pointer;
      text-decoration: none;
    }

    .link:hover {
      text-decoration: underline;
    }

    button {
      width: 100%;
      padding: 11px 14px;
      border-radius: 999px;
      border: none;
      background: linear-gradient(135deg, #3b82f6, #1d4ed8);
      color: #f9fafb;
      font-weight: 600;
      font-size: 15px;
      cursor: pointer;
      margin-top: 6px;
      transition: transform 0.08s ease-out, box-shadow 0.08s ease-out, opacity 0.1s;
      box-shadow: 0 12px 30px rgba(37, 99, 235, 0.55);
    }

    button:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 40px rgba(37, 99, 235, 0.7);
    }

    button:active {
      transform: translateY(0);
      box-shadow: 0 8px 20px rgba(37, 99, 235, 0.5);
      opacity: 0.95;
    }

    .error {
      display: none;
      margin-top: 10px;
      font-size: 13px;
      color: #f97373;
    }

    .footer {
      margin-top: 16px;
      font-size: 12px;
      text-align: center;
      color: #6b7280;
    }

    .footer a {
      color: #60a5fa;
      text-decoration: none;
    }

    .footer a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <div class="card">
    <div class="logo">SuperParty · Login</div>
    <div class="subtitle">Autentificare angajați · acces la evenimente și AI</div>

    <form id="loginForm">
      <label for="email">Email</label>
      <input id="email" type="email" placeholder="ex: nume@superparty.ro" required />

      <label for="password">Parolă</label>
      <input id="password" type="password" placeholder="Parola ta" required />

      <div class="actions-row">
        <span></span>
        <span class="link" onclick="goToRegister()">Creează cont nou</span>
      </div>

      <button type="submit" id="loginBtn">Autentificare</button>
    </form>

    <div id="error" class="error"></div>

    <div class="footer">
      SuperParty · acces doar pentru colaboratori validați.
    </div>
  </div>

  <script>
    const BACKEND_URL = "https://script.google.com/macros/s/AKfycbxs819m4gt-tpTkAIIS91EnxhwYx-5wdbnh6Zi5_GcY14zs5XYqS9ykFuYCCcokhQ/exec";

    function showError(msg) {
      const el = document.getElementById("error");
      el.textContent = msg || "Eroare la autentificare.";
      el.style.display = "block";
    }

    function hideError() {
      const el = document.getElementById("error");
      el.style.display = "none";
    }

    function setLoading(isLoading) {
      const btn = document.getElementById("loginBtn");
      btn.disabled = isLoading;
      btn.textContent = isLoading ? "Se autentifică..." : "Autentificare";
      btn.style.opacity = isLoading ? "0.7" : "1";
    }

    function goToRegister() {
      window.location.href = "/register/";
    }

    function handleLoginResponse(res) {
      setLoading(false);
      if (!res || !res.success) {
        showError(res && (res.error || res.message) ? (res.error || res.message) : "Email sau parolă incorecte.");
        return;
      }

      hideError();
      window.location.href = "/angajat/";
    }

    document.getElementById("loginForm").addEventListener("submit", function (e) {
      e.preventDefault();
      hideError();

      const email = document.getElementById("email").value.trim();
      const password = document.getElementById("password").value;

      if (!email || !password) {
        showError("Completează emailul și parola.");
        return;
      }

      setLoading(true);

      const cbName = "cbLogin_" + Date.now();
      window[cbName] = function (res) {
        try {
          handleLoginResponse(res);
        } finally {
          delete window[cbName];
        }
      };

      const url =
        BACKEND_URL +
        "?action=login" +
        "&email=" + encodeURIComponent(email) +
        "&password=" + encodeURIComponent(password) +
        "&callback=" + cbName;

      const s = document.createElement("script");
      s.src = url;
      s.onerror = function () {
        setLoading(false);
        showError("Nu se poate contacta serverul. Încearcă din nou.");
        delete window[cbName];
      };
      document.body.appendChild(s);
    });
  </script>
</body>
</html>
